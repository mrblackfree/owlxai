{% extends "/layouts/modal.twig" %}

{% set title = p__('title', 'Toss Payments settings') %}

{% block body %}
<form class="flex flex-col gap-8" @submit.prevent="submit">
	<div>
		<div class="font-semibold">
			{{ p__('label', 'Status') }}
		</div>

		<label class="inline-flex items-center gap-2 mt-2">
			<input type="checkbox" name="is_enabled" class="checkbox" {{ option.tosspayments.is_enabled is defined and option.tosspayments.is_enabled ? 'checked' : '' }} />
			{{ p__('input-value', 'Enable Toss Payments') }}
		</label>

		<ul class="flex flex-col gap-1 text-xs list-disc list-inside mt-2 text-intermediate-content">
			<li>
				{{ __('To use Toss Payments, you need to register at %s', '<a href="https://www.tosspayments.com" target="_blank" class="underline">tosspayments.com</a>')|raw }}
			</li>
		</ul>
	</div>

	<div>
		<div class="font-semibold">
			{{ p__('label', 'Environment') }}
		</div>

		<label class="inline-flex items-center gap-2 mt-2">
			<input type="checkbox" name="is_live" class="checkbox" {{ option.tosspayments.is_live is defined and option.tosspayments.is_live ? 'checked' : '' }} />
			{{ p__('input-value', 'Live mode') }}
		</label>

		<ul class="flex flex-col gap-1 text-xs list-disc list-inside mt-2 text-intermediate-content">
			<li>
				{{ __('When disabled, Toss Payments will use test mode. Enable for production use.') }}
			</li>
		</ul>
	</div>

	<div>
		<label>
			{{ p__('label', 'Client Key') }}

			<input type="text" name="client_key" class="mt-2 input" autocomplete="off" value="{{ option.tosspayments.client_key ?? '' }}" />
		</label>

		<ul class="flex flex-col gap-1 text-xs list-disc list-inside mt-2 text-intermediate-content">
			<li>
				{{ __('You can find your Client Key in the Toss Payments dashboard under API Keys.') }}
			</li>
		</ul>
	</div>

	<div>
		<label>
			{{ p__('label', 'Secret Key') }}

			<input type="password" name="secret_key" class="mt-2 input" autocomplete="new-password" value="{{ option.tosspayments.secret_key ?? '' }}" />
		</label>

		<ul class="flex flex-col gap-1 text-xs list-disc list-inside mt-2 text-intermediate-content">
			<li>
				{{ __('You can find your Secret Key in the Toss Payments dashboard under API Keys.') }}
			</li>
			<li>
				{{ __('Keep this key secure and never share it publicly.') }}
			</li>
		</ul>
	</div>

	<div>
		<div class="font-semibold">
			{{ p__('label', 'Webhook URL') }}
		</div>

		<div class="mt-2">
			<div class="flex items-center gap-2">
				<input type="text" class="input" readonly value="{{ base_url }}/webhooks/tosspayments" id="webhook-url" />
				<button type="button" class="button button-sm" @click="copyToClipboard">
					{{ p__('button', 'Copy') }}
				</button>
			</div>
		</div>

		<ul class="flex flex-col gap-1 text-xs list-disc list-inside mt-2 text-intermediate-content">
			<li>
				{{ __('Add this URL to your Toss Payments webhook settings in the dashboard.') }}
			</li>
			<li>
				{{ __('This URL will receive payment notifications from Toss Payments.') }}
			</li>
		</ul>
	</div>

	<div>
		<button type="submit" class="w-full button">
			{{ p__('button', 'Save changes') }}
		</button>
	</div>
</form>

<script>
document.addEventListener('alpine:init', () => {
	Alpine.data('modal', () => ({
		copyToClipboard() {
			const input = document.getElementById('webhook-url');
			input.select();
			document.execCommand('copy');
			
			toast.show('{{ __("Webhook URL copied to clipboard") }}', 'ti ti-copy');
		}
	}));
});
</script>
{% endblock %}
