{# Modern Account Menu #}
<div class="relative" x-data="{ open: false }" @click.outside="open = false">
	<button type="button" 
			class="w-full flex items-center gap-3 px-3 py-2 rounded-xl hover:bg-white/5 transition-colors group"
			@click="open = !open">
		{# User Avatar #}
		<div class="relative">
			{% if user.avatar %}
				<img src="{{ user.avatar }}" 
					 alt="{{ user.first_name }}" 
					 class="w-10 h-10 rounded-xl object-cover border-2 border-white/20">
			{% else %}
				<div class="w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white font-bold">
					{{ user.first_name|slice(0, 1)|upper }}
				</div>
			{% endif %}
			
			{# Online Status Indicator #}
			<div class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-main"></div>
		</div>

		{# User Info #}
		<div class="text-left overflow-hidden group-data-collapsed/html:hidden">
			<div class="text-sm font-medium truncate">
				{{ user.first_name }} {{ user.last_name }}
			</div>
			<div class="text-xs text-content-dimmed truncate">
				{{ user.email }}
			</div>
		</div>

		{# Chevron #}
		<i class="ti ti-chevron-down ml-auto text-content-dimmed group-data-collapsed/html:hidden transition-transform"
		   :class="{ 'rotate-180': open }"></i>
	</button>

	{# Dropdown Menu #}
	<div x-show="open" 
		 x-transition
		 class="absolute left-0 right-0 bottom-full mb-2 glass-morphism rounded-xl shadow-xl overflow-hidden">
		
		{# Quick Stats #}
		<div class="p-4 border-b border-white/10">
			<div class="grid grid-cols-2 gap-4 text-center">
				<div>
					<div class="text-2xl font-bold gradient-text">
						{{ workspace.document_count ?? 0 }}
					</div>
					<div class="text-xs text-content-dimmed">{{ __('Documents') }}</div>
				</div>
				<div>
					<div class="text-2xl font-bold gradient-text">
						{{ workspace.used_credit_count ?? 0 }}
					</div>
					<div class="text-xs text-content-dimmed">{{ __('Credits Used') }}</div>
				</div>
			</div>
		</div>

		{# Menu Items #}
		<div class="py-2">
			<a href="app/account" 
			   class="flex items-center gap-3 px-4 py-2.5 hover:bg-white/5 transition-colors">
				<i class="ti ti-user-circle text-lg"></i>
				<span class="text-sm font-medium">{{ __('My Profile') }}</span>
			</a>
			
			<a href="app/account/security" 
			   class="flex items-center gap-3 px-4 py-2.5 hover:bg-white/5 transition-colors">
				<i class="ti ti-shield-check text-lg"></i>
				<span class="text-sm font-medium">{{ __('Security') }}</span>
			</a>
			
			<a href="app/billing" 
			   class="flex items-center gap-3 px-4 py-2.5 hover:bg-white/5 transition-colors">
				<i class="ti ti-credit-card text-lg"></i>
				<span class="text-sm font-medium">{{ __('Billing') }}</span>
			</a>
			
			{% if user.role == 'admin' %}
				<div class="my-2 border-t border-white/10"></div>
				
				<a href="{{ view_namespace == 'admin' ? 'app' : 'admin' }}" 
				   class="flex items-center gap-3 px-4 py-2.5 hover:bg-white/5 transition-colors">
					<i class="ti ti-{{ view_namespace == 'admin' ? 'sparkles' : 'settings' }} text-lg"></i>
					<span class="text-sm font-medium">
						{{ view_namespace == 'admin' ? __('Switch to App') : __('Admin Panel') }}
					</span>
				</a>
			{% endif %}
			
			<div class="my-2 border-t border-white/10"></div>
			
			<a href="logout" 
			   class="flex items-center gap-3 px-4 py-2.5 hover:bg-white/5 transition-colors text-red-500">
				<i class="ti ti-logout text-lg"></i>
				<span class="text-sm font-medium">{{ __('Sign Out') }}</span>
			</a>
		</div>
	</div>
</div>
